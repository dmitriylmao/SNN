# Прогнозирование движения цен акций Сбербанка с помощью SNN

Этот проект использует спайковые нейронные сети (SNN) на базе SNNtorch для классификации движения цены акций Сбербанка (рост/падение) на следующий день.

## Структура проекта

- `data/`: содержит CSV файл с историческими данными акций (`SBER_stock_data.csv`).
- `snn_model/`: определяет архитектуру SNN (`snn_classifier.py`).
- `utils/`: содержит утилиты для загрузки и обработки данных (`data_processing.py`).
- `main.py`: главный скрипт для обучения, оценки и визуализации.
- `requirements.txt`: список необходимых Python библиотек.

## Запуск

1.  **Установите зависимости:**
    ```bash
    pip install -r requirements.txt
    ```
2.  **Подготовьте данные:**
    Скачайте исторические данные по акциям Сбербанка (например, с Yahoo Finance, тикер `SBER.ME`) и сохраните их как `data/SBER_stock_data.csv`. Файл должен содержать колонки `Date,Open,High,Low,Close,Volume`.
3.  **Запустите обучение:**
    ```bash
    python main.py
    ```

## Оценка максимальной точности

Предсказание финансовых рынков — чрезвычайно сложная задача. Исторические данные о ценах сами по себе содержат ограниченное количество информации о будущих движениях, так как рынки подвержены влиянию множества внешних, часто непредсказуемых факторов, и обладают свойствами, близкими к случайному блужданию.

**Для данного набора данных (только исторические цены/объемы):**

-   **Реалистичные ожидания:** Точность классификации (рост/падение) немного выше 50% (например, 52-58%) уже может считаться неплохим результатом для простой модели. Значения выше 60-65% на чистых исторических данных без инсайдерской информации или очень сложных моделей встречаются редко и часто могут быть результатом переобучения.
-   **Факторы, влияющие на точность:**
    -   **Качество и репрезентативность данных:** Период, волатильность рынка в этот период.
    -   **Инжиниринг признаков:** Какие технические индикаторы или производные от цены используются.
    -   **Архитектура SNN:** Количество слоев, нейронов, тип нейронов, параметры (например, `beta` для LIF).
    -   **Метод кодирования в спайки:** Rate, latency, delta modulation и т.д. (в данном примере используется аналоговый вход в первый слой, что является распространенной практикой).
    -   **Гиперпараметры обучения:** Скорость обучения, размер батча, количество эпох, оптимизатор.
    -   **Длина последовательности:** Сколько прошлых дней учитывается для предсказания.
-   **"Выжать максимум":**
    -   Требует **тщательного подбора признаков** (возможно, более сложных технических индикаторов).
    -   **Оптимизации гиперпараметров** (например, с помощью техник вроде Grid Search, Random Search, или байесовской оптимизации с использованием библиотек типа Optuna).
    -   Экспериментов с **различными архитектурами SNN** и параметрами спайковых нейронов.
    -   Использования техник **регуляризации** для борьбы с переобучением (L1/L2, Dropout для неспайковых частей, если есть).
    -   Валидации на отложенных данных (walk-forward validation) для более надежной оценки.

**Ограничения:** Сама природа финансовых данных является главным ограничителем. SNN предлагают энергоэффективный и биологически правдоподобный подход к обработке информации, но они не могут создать предсказательную силу там, где ее изначально мало в данных.

Этот проект предоставляет базовую структуру для экспериментов с SNN на финансовых данных.